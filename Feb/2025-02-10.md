# TIL Template

## 날짜: 2025-02-10

### 스크럼
- 학습 목표 1 : 오전 강의 내용 정리
- 학습 목표 2 : 오후 강의 내용 정리

### 새로 배운 내용
#### 주제 1: 도커 개념 및 명령어
- 리눅스 컨테이너에 여러 기능을 추가
- 어플리케이션을 컨테이너로 좀 더 쉽게 사용할 수 있게 만든 오픈소스 프로젝트
- 가상머신과 달리 성능손실이 거의 없음
- 게스트 OS 설치 X
```
도커 => 컨테이너
k8s, k3s, EKS, AKS, ECS => 컨테이너를 관리하는 툴(오케스트레이션 솔루션)
```

1. 가상머신과 도커 컨테이너
**가상머신**
- 하이퍼버이저를 통한 가상화로 기존 PC에 성능 손실이 발생
- 완벽한 독립적 공간, But 이미지 용량이 ↑
- *KVM 성능을 통해 부하를 받겠다 (ex. Auto Scaiing)*

**도커 컨테이너**
- 리눅스  Chroot, 네임스페이스, Cgroup을 사용한 프로세스 단위 격리 환경 구성
- 라이브러리만 포함한 이미지 생성으로 용량 ↓
- *멀티pod을 이용해 부하분산을 하는게 목표*
- argoCD가 Helm차트를 보고 있다가 차트가 변경되면 싱크를 맞추게 됨

## 생성 방법
1. 현재 구동 중인 Container에 있는 그대로 image로 만드는 방법
![[Pasted image 20250210112738.png]]

2.  `Dockerfile`을 이용하여 생성을 선언하는 방법
![[Pasted image 20250210112747.png]]


## 배포방법
1. 파일배포
	- 추출한 이미지 파일을 복사 후 저장
2.  Public registry (도커 허브,  Amazon ECR, Azure Container Registry 등)
	- 이미지 클라우드 저장소
3. Private registry
	- 사용자가 직접 도커 이미지 저장소를 구성


## 볼륨을 사용하는 세 가지 방법
1. Host의 폴더를 직접 공유
2. 불륨 컨테이너 공유 *(??이게 뭐지??)*
3. 도커에서 지원하는 volume을 사용
- 컨테이너끼리 종속적이지 X (컨테이너를 삭제해도 볼륨은 삭제 X)
- Host에서 저장 위치가 어디인지 몰라도 됨.(도커가 관리)
- 볼륨 하나에 여러 컨테이너를 연결할 수 있음

3. Dockerfile
#### Infra as Code
-> 인프라가 코드로 관리 된다는 의미

⊕ 장점
- Imgae 생성 자동화 => Manaul 작업 불필요
- Infra의 변경 관리 => 소스처럼 git 등의 버전관리 도구를 활용 가능, 코드 리뷰
- 빠른 복구 => 북구 상황이 이미 기술되어 있음
- 빠른 배포 => file로 전달하면 됨
	- 이미지 배포 대신, dockerfile 자체를 배포
- 내부 내용 명확히 확인
	- dockerfile에 어떤 작업들이 되어 있는지 쉽게 확인할 수 있음

## 명령어

![[Pasted image 20250210143517.png]]

=> RUN 명령어를 통해 명령어가 실행될 때마다 Layer가 추가된다. && 명령어를 통해 여러 명령어를 한 줄로 만들어주면 레이어가 하나만 생성됨
=> 레이어가 줄면 용량이 줄어듬(아래 이미지 참고)
	![[Pasted image 20250210144915.png]]


## Multistage dockerfile build
-> 여러 단계로 나뉘어서 작업을 하고, 나중에 합치는 것
-> 목적에 맞춰서 image를 분리, 필요 시 합침

![[Pasted image 20250210152002.png]]
=> Go 프로그램을 실행한다고 할 때, complie에 필요한 golang과 운영하는 alpine 등으로 나누어서 운영함


## ONBUILD
-> 빌드된 이미지를 기반으로 하는 다른 이미지가 DOckerfile로 실행될 때 실행할 명령어를 추가
- 운영환경을 만들고, app을 올릴 때 사용

## HEALTHCHECK
-> 이미지로부터 생성된 컨테이너의 어플리케이션 상태 체크 설정


### 오늘의 도전 과제와 해결 방법
- 도전 과제 1: X

### 오늘의 회고
- 도커를 사용해봤지만 자세히 공부하고 사용한 적은 없어서 처음 보는 개념이 많았다. 또 명령어 위주의 개념이 많아서 다 외우고 사용해보려면 좀 시간이 걸릴 것 같다는 생각을 했다.

### 참고 자료 및 링크
- X
